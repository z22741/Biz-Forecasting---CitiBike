---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
library(fpp2)
library(fpp)
library(gtools)
library(ggplot2)
library(zoo)
```
### Check if the colname is different
```{r}
col_name_ori = colnames(read.csv("Dataset/2019 - Q1.csv"))

check_colname <- function(df){
  # Input: Data frame
  # Output: Vector
  temp_TF = colnames(df) %in% col_name_ori
  temp_name = colnames(df[!temp_TF])
  result = which(temp_TF == FALSE)
  if ( length(temp_name) != 0 ){
    return(FALSE)
  } 
  return(TRUE)
}
```
### Import Dataset
```{r}
bike_data = data.frame(matrix(ncol = 6, nrow = 0))
for (i in c(2014:2019)){
  for (j in c(1:4)){
    # import file
    file_name = paste0("Dataset/", i, " - Q", j, ".csv")
    if(!file.exists(file_name)){
      break()
    }
    temp_df = read.csv(file_name)
    # check if same colname
    print(file_name)
    result = check_colname(temp_df)
    if (result){
      bike_data = smartbind(bike_data, temp_df)
    }
  }
}
```
### Dim
```{r}
dim(bike_data)
```
### Structure
```{r}
str(bike_data)
```
### Rename Col
```{r}
col_name = c("Date", "Trips in 24H","Miles in 24H", 
             "Total Annual Member", "24H Pass", "3D Pass")
colnames(bike_data) = col_name
```
### Check Missing Data
```{r}
sum(is.na(bike_data))
```
### Transfer Factor to Data
```{r}
df_len = length(bike_data$Date)
bike_data$Date = as.character(bike_data$Date)
bike_data$Date = c(as.Date(bike_data$Date[1:730], format = "%m/%d/%y"), as.Date(bike_data$Date[731:df_len], format = "%m/%d/%Y")) 
```
### Plotting
```{r}
ggplot(bike_data, aes(x = bike_data$Date, y = bike_data$`24H Pass`)) + geom_point() +
  labs(title="Yr Vs 24H Pass", y="24H Pass", x="Year", caption="Midwest Demographics") +
  geom_point(col="steelblue")
```
### Dataframe to Time Series
```{r}
ts_bike = ts(zoo(bike_data$`24H Pass`, order.by=bike_data$Date),  frequency=1)
```

```{r}
a = acf(ts_bike)
```

